<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="/main.css">
</head>

<body>
    <h1>Use time well</h1>
    <p id='timer'>30m 0s</p>
    <input id='start' type='button' value='start' />
    <input id='stop' type='button' value='stop' style="display: none" />
    <div>
        <p>
            Reviews of the three noises I've chosen.
        </p>
        <p>
            Coffinity - sound of cafe, more loud. Very effective if you're working in a noisey place, as it makes
            everything blur. Also if you're working alone, makes you feel a bit less isolated.
            Very occasionally distracting. My more extroverted work music.
        </p>
        <p>
            Noisli - Mix and match sounds from the site. Also has a timer too. Need an account to access,
            and can be a bit distracting to find the perfect mix of sounds. More if you want to get some space and feel
            a bit more alone. My more introverted work music.
            Top combo - rain, thunder and brown noise.
        </p>
        <p>
            Lofi hip hop mix - nice, main risk is this is a youtube video and the video is a bit distracting. But is
            nice and relaxing to work to. 2 hours of music.
            Makes you feel like you're in one of the panoramic shots by Johnny Harris for Vox.
        </p>
        <a href="https://coffitivity.com" target="_blank" rel="noopener noreferrer">Coffivity</a>
        <a href="https://www.noisli.com" target="_blank" rel="noopener noreferrer">Nosili</a>
        <a href="https://www.youtube.com/watch?v=-FlxM_0S2lA" target="_blank" rel="noopener noreferrer">Lofi hip hop
            mix</a>
        <a href="https://github.com/Tagrand/work-better" target="_blank" rel="noopener noreferrer">Source code</a>
    </div>
</body>

<script>
    window.addEventListener('load', () => {
        var x = undefined

        document.getElementById('start').onclick =
            (event) => {
                if (!!x) {
                    clearInterval(x);
                }

                document.title = 'RUNNING';
                const endTime = new Date();
                endTime.setMinutes(endTime.getMinutes() + 30)

                x = setInterval(() => {
                    const remainingTime = endTime - new Date();
                    const hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);
                    let time = seconds + "s ";

                    if (remainingTime < 0) {
                        clearInterval(x);
                        const ding = new Audio('type-writer-ding.wav');
                        document.getElementById("timer").innerHTML = 'COMPLETE';
                        const stop = document.getElementById('stop');
                        stop.style.display = 'none';
                        event.target.style.display = '';
                        document.title = 'COMPLETE';
                        ding.play()
                        return;
                    }

                    if (hours > 0) {
                        time = hours + 'h ' + minutes + 'm ' + time;
                    }
                    else if (minutes > 0) {
                        time = minutes + "m " + time;
                    }

                    document.getElementById('timer').innerHTML = time;

                    const stop = document.getElementById('stop');
                    stop.style.display = '';
                    event.target.style.display = 'none';
                }, 500);
            }

        document.getElementById('stop').onclick =
            (event) => {
                if (!!x) {
                    clearInterval(x);
                }

                document.getElementById("timer").innerHTML = "STOPPED";
                document.title = 'STOPPED';
                const start = document.getElementById('start');
                start.style.display = '';
                event.target.style.display = 'none';
                return;
            }
    })
</script>

</html>