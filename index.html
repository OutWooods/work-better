<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="/main.css">
    <script src="https://unpkg.com/feather-icons"></script>
</head>

<body>
    <h1>Use time well</h1>
    <h2>A few tips on this site. Take or leave as you wish</h2>
    <p>
        Trust the timer. Ideally avoid looking back on it. If you need to. Pay attention as you click. You'll see a
        RUNNING message on the tab. The reason for this is that the more time you think and check the time, the more
        you're breaking from the task.
    </p>
    <p>
        Avoid music (except the lofi below) unless it's the only way to get you to work.
        Music is distracting, making decisions about it is distracting. But sometimes you do need something to ramp you
        up. There are three tracks, but working in silence is surprisingly pleasant if you can.
    </p>
    <h2>Timer</h2>
    <div>
        <span id='timer'>30m 0s</span>
        <span style='display: none;' id='focus-info'> Current focus: </span>
        <span id='focus-area'></span>
    </div>
    <input id='start' type='button' value='start' />
    <input id='stop' type='button' value='stop' style="display: none" />
    <br />
    <div id='completed-areas' style='display: none'>
        <h2>Completed Tasks</h2>
    </div>
    <div>
        <h2>Focus areas cycle count</h2>
        <div id="focus-areas">
        </div>
        <form>
            <span>New focus:</span>
            <input type="text" id="new-focus" />
            <input id='add-new-focus' type='button' value='create' />
        </form>
    </div>
    <br />
    <div>
        <h2>Reviews of the three noises I've chosen</h2>
        <p>
            <a href="https://coffitivity.com" target="_blank" rel="noopener noreferrer">Coffivity</a>
            Coffinity - sound of cafe, more loud. Very effective if you're working in a noisey place, as it makes
            everything blur. Also if you're working alone, makes you feel a bit less isolated.
            Very occasionally distracting. My more extroverted work music.
        </p>
        <p>
            <a href="https://www.noisli.com" target="_blank" rel="noopener noreferrer">Nosili</a>
            Noisli - Mix and match sounds from the site. Also has a timer too. Need an account to access,
            and can be a bit distracting to find the perfect mix of sounds. More if you want to get some space and
            feel
            a bit more alone. My more introverted work music.
            Top combo - rain, thunder and brown noise.
        </p>
        <p>
            <a href="https://www.youtube.com/watch?v=-FlxM_0S2lA" target="_blank" rel="noopener noreferrer">Lofi hip
                hop
                mix</a>
            Lofi hip hop mix - nice, main risk is this is a youtube video and the video is a bit distracting. But is
            nice and relaxing to work to. 2 hours of music.
            Makes you feel like you're in one of the panoramic shots by Johnny Harris for Vox.
        </p>
        <a href="https://coffitivity.com" target="_blank" rel="noopener noreferrer">Coffivity</a>
        <a href="https://www.noisli.com" target="_blank" rel="noopener noreferrer">Nosili</a>
        <a href="https://www.youtube.com/watch?v=-FlxM_0S2lA" target="_blank" rel="noopener noreferrer">Lofi hip hop
            mix</a>
        <br />
        <a href="https://github.com/Tagrand/work-better" target="_blank" rel="noopener noreferrer">Source code</a>
    </div>
</body>
<script>feather.replace()</script>
<script>
    var focusArea = undefined;
    var areasOfFocus = [];
    var completedTasks = [];

    const changeCount = (index, amount = 1) => {
        const newCount = areasOfFocus[index].count + amount;
        if (newCount >= 0) {
            areasOfFocus[index].count = newCount
            document.getElementById(`count-${index}`).innerHTML = areasOfFocus[index].count;
            return;
        }

        areasOfFocus[index].count = 0;
        document.getElementById(`count-${index}`).innerHTML = 0;
    }

    const createButton = (clickEvent, extras = {}) => {
        const { feather, innerHTML } = extras;
        const button = document.createElement('button');
        button.onclick = clickEvent;
        if (feather) {
            featherIcon = document.createElement('i')
            featherIcon.dataset.feather = feather
            button.appendChild(featherIcon);
        } else {
            button.innerHTML = innerHTML;
        }
        return button;
    }

    const formatTime = (time) => {
        const hours = Math.floor((time % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((time % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((time % (1000 * 60)) / 1000);
        const formattedSeconds = seconds + "s ";

        if (hours > 0) {
            return hours + 'h ' + minutes + 'm ' + formattedSeconds;
        }

        if (minutes > 0) {
            return minutes + "m " + formattedSeconds;
        }

        return formattedSeconds;
    }

    const formatDate = (time) => {
        return time.getHours() + ':' + time.getMinutes();
    }

    const completeTask = (task, start, end) => {
        const taskData = {
            start,
            end,
            name: task.name,
        }

        changeCount(task.id);
        completedTasks.push(taskData);
        const completedTask = document.createElement('div');
        const taskName = document.createElement('span');
        taskName.innerHTML = taskData.name;
        const startTime = document.createElement('span');
        startTime.innerHTML = ' Start: ' + formatDate(start);
        const endTime = document.createElement('span');
        endTime.innerHTML = ' End: ' + formatDate(end);
        const taskLength = document.createElement('span');
        taskLength.innerHTML = ' Length: ' + formatTime(start - end);
        completedTask.appendChild(taskName);
        completedTask.appendChild(startTime);
        completedTask.appendChild(endTime);
        completedTask.appendChild(taskLength);
        document.getElementById('completed-areas').style.display = '';
        document.getElementById('completed-areas').appendChild(completedTask);
    }
</script>
<script src="counter.js"></script>
<script src="timer.js"></script>

</html>